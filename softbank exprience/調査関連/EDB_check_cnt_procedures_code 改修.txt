DECLARE
d_target  date;  
  bgn_date  date;  -- 開始時間(パラメータはYYYYMMDDHH24MISS)
  end_date  date;  -- 終了時間(パラメータはYYYYMMDDHH24MISS)
  row_cnt   number(10);

begin
    bgn_date  := to_date(i_begin,'yyyymmddhh24miss');
    end_date  := to_date(i_end,'yyyymmddhh24miss');

    d_target := bgn_date;

    LOOP

        select count(*) into row_cnt from DSE_D_BILLGROUPPERSON as of SYSTEM TIME(d_target);
        -- 一分ごとに、カウント
        d_target := bgn_date + 1/24/60;

        dbms_output.put_line( to_char(d_target,'yyyymmdd hh24miss')||' : '||to_char(row_cnt));


 

        if d_target > end_date then
	    EXIT;
        end if;

    END LOOP;

    exception
       when others then
           dbms_output.put_line( sqlerrm);

end;
 